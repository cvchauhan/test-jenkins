<p-toast [baseZIndex]="100000"></p-toast>
<p-confirmDialog key="positionDialog" [position]="position"></p-confirmDialog>
<p-confirmDialog [style]="{width: '30vw'}" [baseZIndex]="10000"></p-confirmDialog>
<!-- <p-messages [value]="msgs" [style]="{width: '30vw'}" ></p-messages> -->
<div class="dashboard">
    <div class="p-grid p-nogutter">
        <div class="p-col-12 p-md-4">
            <form [formGroup]="serviceFormGroup" (ngSubmit)="submitServiceF(serviceFormGroup)">
                <div class="p-grid p-nogutter">
                    <div class="p-col-12">
                        <div class="p-grid p-nogutter grid-gutter">
                            <div class="p-col-12 p-md-4" id="drop"><label for="first">Service Category<sup>*</sup></label></div>
                            <div class="p-col-12 p-md-8" *ngIf="serviceCategores.length > 0">
                                <p-dropdown placeholder="Select Service Category" [options]="serviceCategores" optionLabel="name" formControlName="nSrvCtgid"></p-dropdown>
                                <div *ngIf="formControl.nSrvCtgid.invalid && (formControl.nSrvCtgid.dirty || formControl.nSrvCtgid.touched)">
                                    <p class="danger" *ngIf="formControl.nSrvCtgid.errors.required">Service Category Is Required</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-col-12">
                        <div class="p-grid p-nogutter grid-gutter">
                            <div class="p-col-12 p-md-4">
                                <label for="middle">Start Date<sup>*</sup></label>
                            </div>
                            <div class="p-col-12 p-md-8">
                                <!-- {{serviceFormGroup.get('')}} -->
                                <p-calendar showButtonBar="true" [showIcon]="true" placeholder="Select Date" formControlName="dStartDt" dateFormat="dd-mm-yy"></p-calendar>
                                <div *ngIf="formControl.dStartDt.invalid && (formControl.dStartDt.dirty || formControl.dStartDt.touched)">
                                    <p class="danger" *ngIf="formControl.dStartDt.errors.required">Start Date Is Required</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-col-12" *ngIf="eDateshow">
                        <div class="p-grid p-nogutter grid-gutter">
                            <div class="p-col-12 p-md-4">
                                <label for="last">End Date</label>
                            </div>
                            <div class="p-col-12 p-md-8">
                                <p-calendar [disabledDates]="invalidDates" [minDate]="minimumDate" [disabledDays]="[0,6]" placeholder="Selct Date" [defaultDate]="defaultDate" formControlName="dEndDt" dateFormat="dd-mm-yy">
                                </p-calendar>
                                <div *ngIf="formControl.dEndDt.invalid && (formControl.dEndDt.touched || formControl.dEndDt.dirty)">
                                    <p class="danger" *ngIf="formControl.dEndDt.errors.required">End Date Is Required</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-col-12">
                        <div class="p-grid p-nogutter grid-gutter">
                            <div class="p-col-12 p-md-4">
                                <label for="last">Service Code<sup>*</sup></label>
                            </div>
                            <div class="p-col-12 p-md-8">
                                <input id="srvCode" type="text" pInputText formControlName="srvCode">
                                <div *ngIf="formControl.srvCode.invalid && (formControl.srvCode.dirty || formControl.srvCode.touched)">
                                    <p class="danger" *ngIf="formControl.srvCode.errors.required">
                                        Service Code Is Required
                                    </p>
                                    <p class="danger" *ngIf="formControl.srvCode.errors.minlength">
                                        Service Code must be at least 3 characters.
                                    </p>
                                    <p class="danger" *ngIf="formControl.srvCode.errors.maxlength">
                                        Your Service Code cannot exceed 7 characters.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-col-12">
                        <div class="p-grid p-nogutter grid-gutter">
                            <div class="p-col-12 p-md-4">
                                <label for="last">Service<sup>*</sup></label>
                            </div>
                            <div class="p-col-12 p-md-8">
                                <input id="cSrvName" type="text" pInputText formControlName="cSrvName">
                                <div *ngIf="formControl.cSrvName.invalid && (formControl.cSrvName.dirty || formControl.cSrvName.touched)">
                                    <p class="danger" *ngIf="formControl.cSrvName.errors.required">
                                        Service Is Required
                                    </p>
                                    <p class="danger" *ngIf="formControl.cSrvName.errors.minlength">
                                        Service must be at least 6 characters.
                                    </p>
                                    <p class="danger" *ngIf="formControl.cSrvName.errors.maxlength">
                                        Your Service cannot exceed 30 characters.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-col-12">
                        <div class="p-grid p-nogutter grid-gutter">
                            <div class="p-col-12 p-md-4">
                                <label for="last">Branch Location<sup>*</sup></label>
                            </div>
                            <div class="p-col-12 p-md-8">
                                <p-multiSelect placeholder="Select Branch Location" [options]="branchData" optionLabel="txt" formControlName="cAppliedBr"></p-multiSelect>
                                <div *ngIf="formControl.cAppliedBr.invalid && (formControl.cAppliedBr.dirty || formControl.cAppliedBr.touched)">
                                    <p class="danger" *ngIf="formControl.cAppliedBr.errors.required">Branch Location Is is required
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-col-12">
                        <div class="p-grid p-nogutter grid-gutter">
                            <div class="p-col-12 p-md-4">
                                <label for="">Mapping Skills Type<sup>*</sup></label>
                            </div>
                            <div class="p-col-12 p-md-8" *ngIf="skillsT">
                                <p-multiSelect class="emp-ddown" placeholder="Select Mapping Skills" formControlName="cSkillType" [options]="skillsType" optionLabel="name" maxSelectedLabels="1" defaultLabel="SELECT" styleClass="multiselect-mobileregulation-width">
                                </p-multiSelect>
                                <p-button (click)="showComboDialog('Skills Type', skillsId); sParrentNoF(skillsId)" class="btn-add emp-addp" icon="pi pi-plus">
                                </p-button>
                                <div *ngIf="formControl.cSkillType.invalid && (formControl.cSkillType.dirty || formControl.cSkillType.touched)">
                                    <p class="danger" *ngIf="formControl.cSkillType.errors.required">Mapping Skills Typ Is Required
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-md-8 p-md-offset-4 p-pl-0">
                        <button pButton type="submit" [disabled]="!serviceFormGroup.valid" label="{{editServiceButton?'Update':'Save' }}"></button>

                        <button style="margin-left: 5px;" (click)="resetServiceF()" *ngIf="editCancelButton" pButton type="button" label="Cancel"></button>
                    </div>
                </div>
            </form>
        </div>
        <div class="p-col-12 p-md-8">
           
            <p-table #info [autoLayout]="true" [value]="sTableList | service:searchService" [paginator]="true" [rows]="rows" [showCurrentPageReport]="true" [(first)]="first" [scrollable]="true" scrollHeight="400px" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            [rowsPerPageOptions]="[10,20,40,80,120]" [globalFilterFields]="['cSrvCategory','srvCode','cSrvName']">
            <ng-template pTemplate="caption">
                <div class="p-grid p-jc-end">
                    <div class="p-col-5">
                        <div  class="search">
                            <input placeholder="Search By Service Code, Service Name & Category Name" (input)="info.filterGlobal($event.target.value,'contains')" type="text" pInputText>
                            <!-- <input placeholder="Search By Service Code, Service Name & Category Name" [ngModelOptions]="{standalone: true}" id="search" type="text" pInputText [(ngModel)]="searchService"> -->
                            <button pButton type="button" icon="pi pi-search" iconPos="left"></button>
                        </div>
                    </div>
                </div>
            </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th>SNo</th>
                        <th pSortableColumn="cSrvCategory">Category <p-sortIcon field="cSrvCategory"></p-sortIcon></th>
                        <th pSortableColumn="dStartDt">Start Date<p-sortIcon field="dStartDt"></p-sortIcon></th>
                        <th pSortableColumn="srvCode">Service Code<p-sortIcon field="srvCode"></p-sortIcon></th>
                        <th pSortableColumn="cSrvName">Service<p-sortIcon field="cSrvName"></p-sortIcon></th>
                        <th>Action</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-tValue let-i="rowIndex">
                    <tr>
                        <td>{{i+1}}</td>
                        <td>{{tValue.cSrvCategory}}</td>
                        <td>{{tValue.dStartDt | dateFormat}}</td>
                        <td>{{tValue.srvCode}}</td>
                        <td>{{tValue.cSrvName}}</td>
                        <td>
                            <p-button icon="pi pi-pencil" class="p-button-raised" (click)="editServiceF(tValue.nSrvid)">
                            </p-button>
                            <p-button icon="pi pi-trash" class="p-button-raised p-button-danger p-ml-2" (click)="delServiceF(tValue.nSrvid);"></p-button>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</div>


<!-- Add new Service Category dailog box -->
<p-dialog header="Add {{currentAddData}}" [(visible)]="displayBasic" [modal]="true" [style]="{width: '35vw'}" [baseZIndex]="10000">
    <form [formGroup]="comboFormGroup">
        <div class="p-grid p-nogutter grid-gutter">
            <div class="p-col-12 p-md-3">
                <label for="ctype">{{categoryName}}</label>
            </div>
            <div class="p-col-12 p-md-9">
                <input id="other" type="text" pInputText formControlName="cCodeName">
                <div *ngIf="contorlForm.cCodeName.invalid && (contorlForm.cCodeName.dirty || contorlForm.cCodeName.touched)">
                    <p class="danger" *ngIf="contorlForm.cCodeName.errors.required">{{categoryName}} Is Required</p>
                </div>
            </div>
        </div>
        <div class="p-grid p-nogutter grid-gutter">
            <div class="p-col-12 p-md-3">
                <label for="parent">Serial Parent No</label>
            </div>
            <div class="p-col-12 p-md-9">
                <p-dropdown appendTo="body" id="parent" formControlName="nParentSerialNo" [options]="sParrentNoRes" optionLabel="codeName" [filter]="true" filterBy="codeName" placeholder="Select Category"></p-dropdown>
            </div>
        </div>
        <div class="p-grid p-nogutter grid-gutter">
            <div class="p-col-12 p-md-3">
                <label for="other">Description</label>
            </div>
            <div class="p-col-12 p-md-9">
                <!-- <textarea rows="3" cols="63" pInputTextarea autoResize="autoResize"></textarea> -->
                <input id="other" type="text" pInputText formControlName="description">
            </div>
        </div>
        <div class="p-grid p-nogutter p-mb-4">
            <div class="p-col-12 p-md-12">
                <p-button (click)="submitComboPopupF(comboFormGroup);displayBasic=false" type="submit" label="Add"></p-button>
            </div>
        </div>
    </form>
</p-dialog>
<!-- Add new Service Categroy dailog box end-->